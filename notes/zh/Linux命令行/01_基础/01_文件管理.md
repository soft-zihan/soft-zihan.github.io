# 📂 文件日常管理 (File Management)

这里涵盖了从查看、创建到移动、删除的所有基础文件操作。

## 0. 命令行的灵魂：Tab 补全

在继续之前，请记住这是提升效率的第一法则：**永远不要手动打全文件名**。

- 输入命令或文件名的前几个字母，按 **`Tab`** 键，系统会自动补全。
- 如果按一下没反应，说明有多个匹配项，连按两下 **`Tab`** 会列出所有候选项。

---

## 1. 浏览与查看 (View)

### pwd (Print Working Directory) - 我在哪？

- **`pwd`**：显示当前你所在的完整路径。当你迷失在多层文件夹中时，它是你的“定位雷达”。

---

### ls (List) - 列出目录内容

- `ls -l`：列表显示详细信息 (权限/所有者/大小/时间)

  - **💡 详情解读**：
    `drwxr-xr-x  2  user  group  4.0K  Jan 1 12:00  my_folder`
    1. `d`：类型 (**d** 目录, **-** 文件, **l** 链接)。
    2. `rwxr-xr-x`：权限位。
    3. `2`：**链接数**。
       - 对文件：有多少个文件名指向它。
       - 对目录：代表它包含的**子目录数量 + 2** (包含自身 `.` 和父目录 `..`)。因此一个空目录的显示数值是 **2**。
       - **举例**：如果你在 `test` 目录下新建一个子目录 `sub`，`test` 的链接数会从 2 变成 3，因为 `sub/..` 也指向了 `test`。
    4. `user`：文件**所有者**。
    5. `group`：文件**所属组**。
       31→    6. `4.0K`：**目录项占用大小**。**注意**：这仅仅是该目录在磁盘索引中占用的空间，**不是**该目录下所有文件的总和。查看目录总大小请使用 `du -sh`；更系统的磁盘空间排查见进阶篇《磁盘与文件系统》。
    6. `Jan 1 12:00`：最后修改时间。
    7. `my_folder`：文件名。
- `ls -a`：显示所有文件 (包含以 `.` 开头的隐藏文件)

  - **💡 理解特殊符号**：
    - **`.`**：代表**当前目录**。
    - **`..`**：代表**上一级目录**。
- `ls -lh`：配合 `-h` 以人类可读格式 (KB/MB/GB) 显示大小。

> 💡 **Pro Tip**: 尝试使用 **`eza`** 替代 `ls` (需安装)，它支持 Git 状态显示、图标和树状视图。

---

### stat - 查看元数据

- `stat file.txt`：显示文件的完整信息。
- **💡 核心概念：Inode (索引节点)**
  - Inode 是文件在磁盘上的“身份证号”，而文件名只是它的“别名”。
  - 一个 Inode 可以对应多个文件名（硬链接），但文件名必须通过 Inode 才能找到真实数据。

---

### cd (Change Directory) - 切换目录

- `cd /path/to/dir`：切换到指定目录。
- **`cd`** (不带参数) 或 **`cd ~`**：快速返回家目录。
- `cd ..`：返回上一级目录。
- `cd .`：停在当前目录 (常用于运行当前目录下的脚本：`./script.sh`)。
- `cd -`：返回上一次所在的目录 (类似电视遥控器的“回看”)。

> 💡 **Pro Tip**: 尝试使用 **`z`** 或 **`zoxide`** 替代 `cd`，实现智能跳转 (如 `z pro` -> `/home/user/projects`)。

---

## 2. 创建与管理 (Create & Manage)

### mkdir (Make Directory) - 创建目录

- `mkdir -p`：递归创建多级目录 (如 `a/b/c`)。

### touch - 创建空文件

- `touch file.txt`：创建一个空文件。

### cp (Copy) - 复制

- `cp -r`：递归复制整个目录。
- `cp -a`：**归档模式**。比 `-r` 更强，它会保留文件的所有属性 (权限、时间戳、链接关系)。
  - **实战场景**：当你需要迁移网站源码或备份配置文件时，**必须用 `-a`**。否则，所有备份文件的“修改时间”都会变成现在，导致你无法根据时间戳排障。
- **更安全的操作**：
  - `cp -i`：覆盖前**询问确认**。
  - `cp -n`：**不覆盖**已存在的文件。
- `cp -u` (update)：仅当源文件较新或目标文件不存在时才复制。

### mv (Move) - 移动与重命名

- `mv a.txt b.txt`：重命名文件。
- `mv file.txt /path/to/dir/`：移动文件到指定目录。
- `mv -i`：覆盖前询问确认。

---

### ln (Link) - 链接

- `ln -s 源文件 软链接`：创建**软链接** (类似 Windows 的快捷方式)。
- `ln 源文件 硬链接`：创建**硬链接** (文件的另一个名字)。

#### 💡 深度对比：软链接 vs 硬链接

| 特性                 | 软链接 (Symbolic Link) | 硬链接 (Hard Link)                      |
| :------------------- | :--------------------- | :-------------------------------------- |
| **本质**       | 一个指向路径的特殊文件 | 同一个 Inode 的不同别名                 |
| **跨文件系统** | 支持 (可跨分区/硬盘)   | **不支持** (必须在同一分区)       |
| **目录链接**   | 支持                   | **不支持**                        |
| **源文件删除** | 链接失效 (变成死链)    | **依然有效** (只要还有一个硬链接) |
| **Inode 编号** | 不同                   | **完全相同**                      |

- **避坑指南**：创建软链接时，源文件**强烈建议写绝对路径**。
  - **为什么？**：如果你使用相对路径（如 `ln -s ./a.txt b.txt`），当你把 `b.txt` 移动到另一个文件夹时，它仍会尝试在“当前新位置”寻找 `./a.txt`，从而导致链接失效。使用绝对路径则无论链接被移到哪都能正确指向目标。

---

### rm (Remove) - 删除 (⚠️ 极度慎用)

- `rm -i`：删除前**询问确认**。
- `rm -rf`：强制递归删除。
- **⚠ 警告**：Linux **没有回收站**！`rm` 之后文件直接从磁盘索引中抹除，极难找回。
- `alias rm='trash'`：**Pro 建议**：安装 `trash-cli` 并设置别名，将删除的文件移动到系统的回收站。

#### 💡 更安全的删除习惯（建议养成）

- **先预览后执行**：能 `ls` 看清楚就不要直接 `rm`；批量删除前先用 `echo` 或 `printf` 打印将要匹配的文件。
- **防止文件名以 `-` 开头**：`rm -- -dangerous-file`（`--` 表示“参数结束”，后面都当作文件名）。
- **带空格/特殊字符的文件名**：始终用引号：`rm "my file.txt"`。

---

## 3. 统计与进阶技巧

### 排序与统计 (配合 ls)

- `ls -lhS`：按文件**大小**排序 (大文件在前)。
- `ls -lht`：按**修改时间**排序 (最近修改在前)。
- `ls -R`：递归列出子目录下所有文件。

### wc (Word Count) - 文本统计

- `wc -l file.txt`：统计行数。
- `ls | wc -l`：统计当前目录下有多少个文件。

### file - 识别文件类型

- `file my_script.sh`：显示文件类型 (如 "Bourne-Again shell script")

### diff - 比较差异

- `diff file1.txt file2.txt`：逐行比较两个文件的不同之处。

> 💡 **Pro Tip**: 尝试使用 **`delta`** 替代 `diff`，它提供极美观的语法高亮和 Git diff 查看体验。
