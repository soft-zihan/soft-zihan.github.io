# ⚡ 终端效率与重定向 (Efficiency & Redirection)

想要像黑客一样飞速操作终端？你需要掌握快捷键、历史命令技巧以及 Linux 最强大的特性——I/O 重定向。

## 1. 终端交互快捷键 (Terminal Shortcuts)

### 文本编辑与进程控制
- **`Tab`**：**自动补全** (本教程最重要的快捷键)。永远不要完整手打文件名！
- **`Ctrl + A` / `Ctrl + E`**：跳转到行首 / 行尾。
- **`Ctrl + U` / `Ctrl + K`**：删除光标前 / 后的所有内容。
- **`Ctrl + C`**：**终止**当前程序 (Kill)。
- **`Ctrl + Z`**：**挂起**当前程序 (Pause)。
  - **⚠️ 避坑**：程序只是暂停并放入后台，并未关闭。输入 **`fg`** 即可把它接回前台。
- **`Ctrl + L`**：清屏 (等同于 `clear`)。
- **`Ctrl + D`**：退出当前 Shell (等同于 `exit`)。

### 历史记录操作 (History Expansion)
- **`!!`**：执行上一条命令 (如 `sudo !!` - 忘了加 sudo 时神器)。
- **`!$`**：引用上一条命令的**最后一个参数**。
  - *场景*：`mkdir /path/to/long/dir` -> `cd !$` (直接进入刚才创建的目录)。
- **`Ctrl + R`**：**搜索历史命令** (Reverse-i-search)。输入关键词即可匹配。
  - > 💡 **Pro Tip**: 强烈推荐安装 **`fzf`**，它会把这个搜索功能变成全屏交互式的，体验飞升。

---

## 2. 核心：I/O 重定向与管道 (Redirection & Pipes)

这是 Linux 哲学的精髓：**将一个命令的输出作为另一个命令的输入。**

### 理解三个“流” (Streams)
1.  **stdin (0)**：标准输入（通常是键盘）。
2.  **stdout (1)**：标准输出（屏幕上的正常提示）。
3.  **stderr (2)**：标准错误（屏幕上的报错信息）。

### 常用重定向符号
- **`>`**：**覆盖写入**。
  - `ls > files.txt`：把文件列表存入 files.txt (原内容清空)。
- **`>>`**：**追加写入**。
  - `echo "Error: 404" >> error.log`：在日志末尾添加一行 (保留原内容)。
- **`2>`**：**仅重定向错误**。
  - `find / -name "test" 2> /dev/null`：把烦人的 "Permission denied" 报错扔进“黑洞” (/dev/null)，只看正常结果。
- **`2>&1`**：**合并输出**。
  - 将错误流 (2) 合并到标准输出流 (1) 中。
  - **`&>`**：(现代简写) 效果等同于 `2>&1`。
- **`|` (管道)**：**核心神技**。
  - 将左边命令的 `stdout` 直接喂给右边命令的 `stdin`。
  - *例子*：`cat access.log | grep "Error" | wc -l`
    - 1. `cat`: 读取文件。
    - 2. `grep`: 过滤出包含 "Error" 的行。
    - 3. `wc -l`: 统计这些行有多少。

### tee - 边看边存（排障必备）
很多时候你既想在屏幕上看输出，又想把它落盘留证据。
- `command | tee output.log`：把输出**同时**打印到屏幕并写入文件。
- `command 2>&1 | tee output.log`：把**标准输出 + 错误输出**都记录下来（更常用）。

### xargs - 把输出变成参数
有些命令不吃 stdin，只吃“参数列表”，这时 `xargs` 就是连接器。
- `printf '%s\n' *.log | xargs -n 1 wc -l`：逐个统计每个文件行数。
- **带空格的安全模式**：优先用 `find ... -print0 | xargs -0 ...`（详见：[查找与搜索](../02_核心/01_查找与搜索.md)）。

---

## 3. 别名管理 (Alias)

通过 `alias` 将长命令变短，打造你的专属终端。

- **临时生效**：直接在终端输入 `alias ll='ls -lha'`。
- **永久生效**：
  1. 打开配置文件：`nano ~/.bashrc` (或 `~/.zshrc`)。
  2. 在文件末尾添加别名行。
  3. 保存退出并运行：**`source ~/.bashrc`** 使其立即生效。

### 💡 推荐配置
```bash
# 常用命令缩写
alias ll='ls -lha'              # 详细列表
alias ..='cd ..'                # 快速返回
alias ...='cd ../..'            # 返回两级

# 安全保护 (防止手滑误删)
alias rm='rm -i'
alias cp='cp -i'
alias mv='mv -i'

# 实用增强
alias grep='grep --color=auto'  # 高亮 grep
alias update='sudo apt update && sudo apt upgrade' # 一键更新
```
