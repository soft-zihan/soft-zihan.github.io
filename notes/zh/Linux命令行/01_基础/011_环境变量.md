# 🌐 环境变量 (Environment Variables)

为什么输入 `ls` 就能运行，而输入我自己写的脚本却报错“command not found”？这背后就是环境变量在起作用。

## 1. 什么是环境变量？
环境变量是操作系统运行时的“全局配置表”。它们定义了系统如何工作、去哪里找程序、默认使用什么编辑器等。

- **查看所有变量**：输入 `env` 或 `printenv`。
- **查看特定变量**：`echo $PATH` (注意变量名前要加 `$`)。

### 常用环境变量
| 变量名 | 含义 | 示例 |
| :--- | :--- | :--- |
| **`PATH`** | **可执行程序的搜索路径** (最重要) | `/usr/bin:/bin:/usr/local/bin` |
| **`USER`** | 当前登录的用户名 | `han` |
| **`HOME`** | 当前用户的家目录 | `/home/han` |
| **`SHELL`** | 当前使用的 Shell | `/bin/bash` |
| **`EDITOR`** | 默认文本编辑器 | `vim` 或 `nano` |
| **`LANG`** | 系统语言编码 | `en_US.UTF-8` |

---

## 2. 核心概念：PATH
**PATH** 是一个由冒号 `:` 分隔的文件夹列表。

### 工作原理
当你输入一个命令（如 `python`）时，系统会按照 PATH 中的目录顺序，**从左到右**依次查找名为 `python` 的可执行文件。
1. 先去 `/usr/local/bin` 找... 没找到。
2. 再去 `/usr/bin` 找... **找到了！** -> 运行它。
3. 如果找遍了所有目录都没找到 -> 报错 `command not found`。

### 实战：把自己的脚本变成命令
假设你写了一个脚本 `hello.sh` 放在 `~/myscripts` 目录下。
1. **直接运行**：必须输入完整路径 `~/myscripts/hello.sh`。
2. **加入 PATH**：如果你把 `~/myscripts` 加入 PATH，以后只需输入 `hello.sh` 就能在任何地方运行它。

---

## 3. 设置与持久化 (export)

### 临时修改 (只对当前终端有效)
```bash
export PATH=$PATH:/home/han/myscripts
```
- **语法解读**：
  - `export`：将变量导出为环境变量（让子进程也能看到）。
  - `$PATH`：**引用**原有的 PATH 值。
  - `:`：分隔符。
  - **结果**：把新目录追加到原有 PATH 的后面。

### 永久修改 (写入配置文件)
如果你想重启后依然有效，必须把命令写入 Shell 的配置文件。

#### 配置文件加载顺序 (生命周期)
Linux 启动时会按特定顺序读取配置文件，理解这个顺序能解决“为什么我的配置没生效”的问题。

1. **Login Shell** (如：SSH 远程登录)
   - 加载顺序：`/etc/profile` -> `~/.bash_profile` (或 `~/.profile`) -> **最后通常会加载 `~/.bashrc`**。
2. **Non-login Shell** (如：在图形界面打开终端)
   - 加载顺序：**直接读取 `~/.bashrc`** (或 `~/.zshrc`)。

#### ✅ 最佳实践
- **个人配置**：永远写在 **`~/.bashrc`** (Bash) 或 **`~/.zshrc`** (Zsh) 中。
  - 这样无论是远程登录还是本地打开终端，配置都会生效。
- **生效命令**：修改后，必须运行以下命令让其立即生效：
  ```bash
  source ~/.bashrc
  ```

---

## 4. 常见问题排查
- **问题**：安装了 Node.js / Python / Go，但终端提示找不到命令。
- **原因**：安装目录没有加入 PATH。
- **解决**：
  1. 找到安装路径 (如 `/usr/local/go/bin`)。
  2. 在 `~/.bashrc` 末尾添加 `export PATH=$PATH:/usr/local/go/bin`。
  3. 执行 `source ~/.bashrc`。
