# 🌸 Sakura Notes

<div align="center">

[![GitHub Pages](https://img.shields.io/badge/GitHub-Pages-222?logo=github)](https://soft-zihan.github.io/)
[![Vue 3](https://img.shields.io/badge/Vue-3.5-4FC08D?logo=vue.js)](https://vuejs.org/)
[![TypeScript](https://img.shields.io/badge/TypeScript-5.4-3178C6?logo=typescript)](https://www.typescriptlang.org/)
[![Tailwind CSS](https://img.shields.io/badge/Tailwind-CSS-38B2AC?logo=tailwind-css)](https://tailwindcss.com/)
[![License](https://img.shields.io/badge/License-MIT-yellow.svg)](LICENSE)
[![zread](https://img.shields.io/badge/Ask_Zread-_.svg?style=flat&color=00b0aa&labelColor=000000&logo=data%3Aimage%2Fsvg%2Bxml%3Bbase64%2CPHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTQuOTYxNTYgMS42MDAxSDIuMjQxNTZDMS44ODgxIDEuNjAwMSAxLjYwMTU2IDEuODg2NjQgMS42MDE1NiAyLjI0MDFWNC45NjAxQzEuNjAxNTYgNS4zMTM1NiAxLjg4ODEgNS42MDAxIDIuMjQxNTYgNS42MDAxSDQuOTYxNTZDNS4zMTUwMiA1LjYwMDEgNS42MDE1NiA1LjMxMzU2IDUuNjAxNTYgNC45NjAxVjIuMjQwMUM1LjYwMTU2IDEuODg2NjQgNS4zMTUwMiAxLjYwMDEgNC45NjE1NiAxLjYwMDFaIiBmaWxsPSIjZmZmIi8%2BCjxwYXRoIGQ9Ik00Ljk2MTU2IDEwLjM5OTlIMi4yNDE1NkMxLjg4ODEgMTAuMzk5OSAxLjYwMTU2IDEwLjY4NjQgMS42MDE1NiAxMS4wMzk5VjEzLjc1OTlDMS42MDE1NiAxNC4xMTM0IDEuODg4MSAxNC4zOTk5IDIuMjQxNTYgMTQuMzk5OUg0Ljk2MTU2QzUuMzE1MDIgMTQuMzk5OSA1LjYwMTU2IDE0LjExMzQgNS42MDE1NiAxMy43NTk5VjExLjAzOTlDNS42MDE1NiAxMC42ODY0IDUuMzE1MDIgMTAuMzk5OSA0Ljk2MTU2IDEwLjM5OTlaIiBmaWxsPSIjZmZmIi8%2BCjxwYXRoIGQ9Ik0xMy43NTg0IDEuNjAwMUgxMS4wMzg0QzEwLjY4NSAxLjYwMDEgMTAuMzk4NCAxLjg4NjY0IDEwLjM5ODQgMi4yNDAxVjQuOTYwMUMxMC4zOTg0IDUuMzEzNTYgMTAuNjg1IDUuNjAwMSAxMS4wMzg0IDUuNjAwMUgxMy43NTg0QzE0LjExMTkgNS42MDAxIDE0LjM5ODQgNS4zMTM1NiAxNC4zOTg0IDQuOTYwMVYyLjI0MDFDMTQuMzk4NCAxLjg4NjY0IDE0LjExMTkgMS42MDAxIDEzLjc1ODQgMS42MDAxWiIgZmlsbD0iI2ZmZiIvPgo8cGF0aCBkPSJNNCAxMkwxMiA0TDQgMTJaIiBmaWxsPSIjZmZmIi8%2BCjxwYXRoIGQ9Ik00IDEyTDEyIDQiIHN0cm9rZT0iI2ZmZiIgc3Ryb2tlLXdpZHRoPSIxLjUiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIvPgo8L3N2Zz4K&logoColor=ffffff)](https://zread.ai/soft-zihan/soft-zihan.github.io)
[![DeepWiki](https://img.shields.io/badge/DeepWiki-_.svg?style=flat&color=00b0aa&labelColor=000000&logo=data%3Aimage%2Fsvg%2Bxml%3Bbase64%2CPHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTY)](https://deepwiki.com/soft-zihan/soft-zihan.github.io)

**一个为 GitHub Pages 设计的纯静态个人博客系统**

[🌐 在线演示](https://soft-zihan.github.io/) · [🐛 报告问题](https://github.com/soft-zihan/soft-zihan.github.io/issues)

</div>

---

## 📑 目录

- [✨ 特性概览](#-特性概览)
- [🎯 快速开始](#-快速开始)
- [📁 项目结构](#-项目结构)
- [🏗️ 技术架构](#️-技术架构)
- [🔧 配置指南](#-配置指南)
- [📝 内容管理](#-内容管理)
- [🔐 安全与数据](#-安全与数据)
- [🤝 贡献指南](#-贡献指南)
- [📜 更新日志](#-更新日志)

---

## ✨ 特性概览

### 🎨 界面与交互

| 特性                   | 描述                                                           |
| ---------------------- | -------------------------------------------------------------- |
| **双主题模式**   | 「日樱」浅色主题 + 「夜樱」深色主题，壁纸随主题切换            |
| **动态樱花背景** | 可拖拽樱花花瓣系统，支持物理效果、网格堆叠、移动端触摸优化     |
| **响应式设计**   | 完美适配桌面端和移动端                                         |
| **多语言支持**   | 内置中/英双语切换 (i18n)，切换时保留当前标签页和实验室位置     |
| **无后端个性化** | 使用 `localStorage` 存储字体、字号、主题、花瓣速度等偏好设置 |

### 📚 内容系统

| 特性                    | 描述                                                                   |
| ----------------------- | ---------------------------------------------------------------------- |
| **Markdown 渲染** | 完整 Markdown 支持，自动目录生成，代码语法高亮                         |
| **全文搜索**      | 基于 MiniSearch 的快速全文检索，支持高亮显示                           |
| **文章管理**      | 收藏、点赞、标签过滤、阅读历史                                         |
| **评论系统**      | 基于[Giscus](https://github.com/giscus/giscus) 的 GitHub Discussions 评论 |
| **音乐播放器**    | 内置音乐播放器，支持歌词显示                                           |

### 🛠️ 发布功能

| 特性                     | 描述                                                  |
| ------------------------ | ----------------------------------------------------- |
| **发布工作台**     | 文件导入预览、重命名、文件夹选择、标签/作者元数据注入 |
| **实时预览**       | 编辑时实时 Markdown 预览                              |
| **图片自动上传**   | Markdown 中的本地图片自动上传至 GitHub                |
| **智能 Fork + PR** | 无写入权限用户自动 Fork 并提交 PR，自动同步最新代码   |

### 🧪 学习实验室

| 特性                     | 描述                                   |
| ------------------------ | -------------------------------------- |
| **7 阶段学习路径** | 从 Web 基础到 Vue 3 进阶的完整学习路线 |
| **交互式组件**     | 可视化教学组件，实时代码演示           |
| **源码查看器**     | 查看本站组件源码，学以致用             |

### 🔐 安全特性

| 特性                     | 描述                                                   |
| ------------------------ | ------------------------------------------------------ |
| **Token 加密存储** | AES-256-GCM 加密，密钥基于浏览器指纹派生               |
| **本地/云端备份**  | 支持本地备份（浏览器）和云端备份（GitHub），可导入导出 |
| **隐私保护**       | 所有数据本地存储，不上传第三方服务器                   |

---

## 🎯 快速开始

### 方式一：Fork 部署（推荐）

1. **Fork 本仓库**

   - 点击右上角 `Fork` 按钮
2. **启用 GitHub Pages**

   - 进入仓库 `Settings` → `Pages`
   - Source 选择 `GitHub Actions`
3. **添加内容**

   - 在 `notes/zh/` 或 `notes/en/` 目录下创建 `.md` 文件
   - 推送代码，GitHub Actions 自动构建部署
4. **访问你的网站**

   - `https://你的用户名.github.io/仓库名/`

### 方式二：本地开发

```bash
# 克隆仓库
git clone https://github.com/soft-zihan/soft-zihan.github.io.git
cd soft-zihan.github.io

# 安装依赖
npm install

# 启动开发服务器
npm run dev

# 构建生产版本
npm run build
```

### 方式三：在线发布

直接访问 [Sakura Notes](https://soft-zihan.github.io/)，点击右上角设置按钮：

1. 输入你的 GitHub Token（需要 `repo` 权限）
2. 配置目标仓库信息
3. 使用发布工作台撰写并发布文章，发布时会自动fork到你的仓库
4. 会自动为你创建 Pull Request

---

## 📁 项目结构

```
sakura-notes/
├── 📄 index.html          # HTML 入口，包含 Tailwind 配置
├── 📄 index.tsx           # Vue 应用挂载入口
├── 📄 App.vue             # 根组件 (~1400 行)，应用核心逻辑
├── 📄 vite.config.ts      # Vite 构建配置
├── 📄 tsconfig.json       # TypeScript 配置
├── 📄 constants.ts        # i18n 国际化常量 (~600 行)
├── 📄 types.ts            # 全局类型定义
│
├── 📁 components/         # Vue 组件
│   ├── AppHeader.vue      # 顶部导航栏
│   ├── AppSidebar.vue     # 侧边栏（筛选/导航）
│   ├── ArticleCard.vue    # 文章卡片组件
│   ├── FileTree.vue       # 递归文件树组件
│   ├── FolderView.vue     # 文件夹网格视图
│   ├── SettingsModal.vue  # 设置面板（含备份功能）
│   ├── WriteEditor.vue    # 发布工作台
│   ├── SearchModal.vue    # 全文搜索模态框
│   ├── DownloadModal.vue  # 批量下载（带筛选）
│   ├── DownloadTreeNode.vue # 下载树节点组件
│   ├── MusicPlayer.vue    # 带歌词的音乐播放器
│   ├── GlobalAudio.vue    # 全局音频控制器
│   ├── GiscusComments.vue # Giscus 评论集成
│   ├── PetalBackground.vue# 樱花花瓣系统（层级可调）
│   ├── WallpaperLayer.vue # 动态壁纸图层
│   ├── BannerSettings.vue # 横幅模式设置
│   │
│   ├── 📁 lab/            # 学习实验室系统
│   │   ├── index.ts              # Lab 导出
│   │   ├── LabDashboard.vue      # 实验室主面板
│   │   ├── SourceCodeViewer.vue  # 带笔记的源码查看器
│   │   ├── DualColumnView.vue    # 双栏阅读视图（全屏）
│   │   ├── PanelContent.vue      # 面板内容（含可折叠树）
│   │   ├── SourceFileTree.vue    # 源码文件树
│   │   ├── LabProjectTour.vue    # 项目导览
│   │   ├── 📁 stage1-foundation/ # Web 基础组件
│   │   ├── 📁 stage2-js-basics/  # JS 基础组件
│   │   ├── 📁 stage3-css/        # CSS 布局组件
│   │   ├── 📁 stage4-js-advanced/# JS 进阶组件
│   │   ├── 📁 stage5-engineering/# 工程化组件
│   │   ├── 📁 stage6-vue-core/   # Vue 核心组件
│   │   ├── 📁 stage7-vue-advanced/# Vue 进阶组件
│   │   └── 📁 stage8-challenge/  # 挑战关卡组件
│   │
│   └── 📁 petal/          # 樱花效果系统
│       └── usePetals.ts   # 花瓣物理引擎
│
├── 📁 composables/        # Vue 3 组合式函数
│   ├── index.ts           # Composable 导出
│   ├── useArticleMeta.ts  # 文章元数据提取
│   ├── useContentRenderer.ts # Markdown 渲染
│   ├── useContentClick.ts # 内容点击处理
│   ├── useGitHubPublish.ts# GitHub 发布 (Fork+PR)
│   ├── useBackup.ts       # 本地/云端备份恢复
│   ├── useTokenSecurity.ts# Token AES-256-GCM 加密
│   ├── useSearch.ts       # MiniSearch 全文搜索
│   ├── useWallpapers.ts   # 壁纸管理
│   ├── useLightbox.ts     # 图片灯箱
│   ├── useMarkdown.ts     # Markdown 工具
│   ├── useCodeModal.ts    # 代码弹窗处理
│   ├── useFile.ts         # 文件操作
│   ├── useRawEditor.ts    # 原始内容编辑器
│   └── useSelectionMenu.ts# 文本选择菜单
│
├── 📁 stores/             # Pinia 状态管理
│   ├── index.ts           # Store 导出
│   ├── appStore.ts        # 全局应用设置
│   ├── articleStore.ts    # 文章交互（收藏/点赞/标签筛选）
│   ├── learningStore.ts   # 学习进度追踪
│   └── musicStore.ts      # 音乐播放状态
│
├── 📁 notes/              # Markdown 笔记内容
│   ├── 📁 zh/             # 中文笔记
│   ├── 📁 en/             # 英文笔记
│   ├── 📁 VUE学习笔记/     # Vue 中文教程
│   └── 📁 VUE Learning/   # Vue English Tutorial
│
├── 📁 public/             # 静态资源
│   ├── files.json         # 文件索引（自动生成）
│   ├── music.json         # 音乐列表（自动生成）
│   ├── wallpapers.json    # 壁纸配置（自动生成）
│   ├── source-notes-preset.json # 预置源码笔记
│   ├── 📁 image/          # 图片资源
│   ├── 📁 music/          # 音乐文件
│   └── 📁 raw/            # 源码查看器用的原始文件
│
└── 📁 scripts/            # 构建脚本
    ├── generate-tree.js   # 生成文件索引
    ├── generate-raw.js    # 复制源码供查看器使用
    ├── generate-music.js  # 扫描音乐文件夹
    └── generate-wallpapers.js # 扫描壁纸文件夹
```

---

## 🏗️ 技术架构

### 整体架构

```
┌─────────────────────────────────────────────────────────┐
│                    客户端 (Browser)                      │
├─────────────────────────────────────────────────────────┤
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐     │
│  │  Vue 3 SFC  │  │   Pinia     │  │  Composables│     │
│  │  Components │  │   Stores    │  │   (逻辑)    │     │
│  └─────────────┘  └─────────────┘  └─────────────┘     │
├─────────────────────────────────────────────────────────┤
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐     │
│  │ localStorage│  │  GitHub API │  │  Static     │     │
│  │  (持久化)   │  │  (发布/备份)│  │  Assets     │     │
│  └─────────────┘  └─────────────┘  └─────────────┘     │
└─────────────────────────────────────────────────────────┘
                           │
                           ▼
┌─────────────────────────────────────────────────────────┐
│              GitHub Pages (静态托管)                     │
├─────────────────────────────────────────────────────────┤
│  index.html + JS bundles + notes/*.md + public/*        │
└─────────────────────────────────────────────────────────┘
                           │
                           ▼
┌─────────────────────────────────────────────────────────┐
│             GitHub Actions (CI/CD)                       │
├─────────────────────────────────────────────────────────┤
│  generate-tree → generate-raw → vite build → deploy     │
└─────────────────────────────────────────────────────────┘
```

### 核心技术栈

| 技术                   | 版本 | 用途                           |
| ---------------------- | ---- | ------------------------------ |
| **Vue 3**        | 3.5  | 前端框架，使用 Composition API |
| **TypeScript**   | 5.4  | 类型安全                       |
| **Vite**         | 4.4  | 构建工具                       |
| **Pinia**        | 3.0  | 状态管理                       |
| **Tailwind CSS** | 3.x  | 原子化 CSS                     |
| **Shiki**        | 1.22 | 代码语法高亮                   |
| **MiniSearch**   | 7.1  | 全文搜索引擎                   |
| **Marked**       | 12.0 | Markdown 解析                  |

### 构建流程

```bash
npm run build
# 等价于:
# 1. node scripts/generate-tree.js  → 扫描 notes/ 生成 public/files.json
# 2. node scripts/generate-raw.js   → 生成源码文件供查看器使用
# 3. node scripts/generate-music.js → 扫描 public/music/ 生成 music.json
# 4. node scripts/generate-wallpapers.js → 生成壁纸配置
# 5. vite build                     → 打包 Vue 应用
```

---

## 🔧 配置指南

### GitHub Token 配置

发布功能需要 GitHub Personal Access Token：

1. 访问 [GitHub Settings → Developer settings → Personal access tokens](https://github.com/settings/tokens)
2. 创建 Token，勾选 `repo` 权限（完整仓库访问）
3. 在网站设置中填入 Token

> ⚠️ Token 使用 AES-256-GCM 加密存储，密钥基于浏览器指纹

### Giscus 评论配置

1. 在你的仓库启用 [GitHub Discussions](https://docs.github.com/en/discussions)
2. 安装 [Giscus App](https://github.com/apps/giscus)
3. 访问 [giscus.app](https://giscus.app/) 获取配置参数
4. 修改 `components/GiscusComments.vue` 中的配置

### 自定义壁纸和音乐

    将图片放入`public/image/wallpapers/` 目录， `.mp3` 文件放入 `public/music/` 目录

---

## 📝 内容管理

### 文件夹组织

```
notes/
├── zh/                    # 中文文章
├── en/                    # 英文文章
│   
├── VUE学习笔记/            # 系列教程（中文）
└── VUE Learning/          # 系列教程（英文）
```

### 使用发布工作台

1. 点击左上角 `写作` 按钮打开发布工作台
2. 支持以下功能：
   - 📝 直接撰写 Markdown
   - 📁 导入本地 `.md` 文件
   - 🖼️ 拖拽/粘贴图片自动上传
   - 🏷️ 添加标签和作者信息
   - 📂 选择发布目录
   - 👁️ 实时预览

---

## 🔐 安全与数据

### Token 安全策略

| 措施                       | 说明                                                          |
| -------------------------- | ------------------------------------------------------------- |
| **AES-256-GCM 加密** | 业界标准对称加密算法                                          |
| **浏览器指纹密钥**   | 密钥基于 userAgent + 屏幕分辨率 + 时区 + 语言派生，设备特异性 |
| **不参与备份**       | Token 明确排除在所有备份操作之外                              |
| **仅用于 API 调用**  | Token 仅发送至 GitHub API，不会发送到其他服务器               |

### localStorage 存储内容

| 数据类型 | 键名前缀                   | 说明                 |
| -------- | -------------------------- | -------------------- |
| 用户偏好 | `app-store`              | 主题、字体、壁纸设置 |
| 文章交互 | `article-store`          | 收藏、点赞           |
| 仓库配置 | `github_*`               | 仓库信息、作者名     |
| 本地备份 | `backup_*`               | 备份数据             |
| Token    | `encrypted_github_token` | 加密后的 Token       |

> ⚠️ **警告**: 清除浏览器数据会丢失这些内容，请定期使用备份功能！

### 发布机制

```
仓库所有者 (有写入权限)        贡献者 (未申请写入权限)
       │                            │
       ▼                            ▼
  直接提交到 main          自动 Fork 仓库
       │                            │
       ▼                            ▼
  触发 GitHub Actions       同步 Fork 到最新
       │                            │
       ▼                            ▼
  自动构建部署              提交到 Fork
                                   │
                                   ▼
                            创建 Pull Request
                                   │
                                   ▼
                            等待仓库所有者审核合并
```

---

## 🤝 贡献指南

### 贡献内容（笔记/文章）

**方式一：网页端发布**

1. 访问 [Sakura Notes](https://soft-zihan.github.io/)
2. 配置你的 GitHub Token
3. 使用发布工作台撰写并发布
4. 系统会自动为你创建 PR

**方式二：直接提交 PR**

1. Fork 本仓库
2. 在 `notes/` 目录下创建 `.md` 文件
3. 提交 PR 到 `main` 分支

### 贡献代码

1. **Fork & Clone**

   ```bash
   git clone https://github.com/你的用户名/soft-zihan.github.io.git
   cd soft-zihan.github.io
   npm install
   ```
2. **创建功能分支**

   ```bash
   git checkout -b feature/你的功能名
   ```
3. **开发与测试**

   ```bash
   npm run dev  # 启动开发服务器
   ```
4. **提交代码**

   ```bash
   git add .
   git commit -m "feat: 添加新功能"
   git push origin feature/你的功能名
   ```
5. **创建 Pull Request**

### Commit 规范

| 类型         | 说明                   |
| ------------ | ---------------------- |
| `feat`     | 新功能                 |
| `fix`      | Bug 修复               |
| `docs`     | 文档更新               |
| `style`    | 代码格式（不影响功能） |
| `refactor` | 重构                   |
| `perf`     | 性能优化               |
| `chore`    | 构建/工具变更          |

---

## 📜 更新日志

### v1.1

- 🐛 修复非仓库所有者提交时的 404 错误
- 🔧 优化权限检查逻辑，提前判断是否需要 Fork + PR
- 🔐 新增 Token AES-256-GCM 加密存储
- 🍴 智能 Fork + PR 系统，自动同步上游
- 💾 本地备份系统，支持导入导出
- 👁️ 发布工作台实时预览
- 🧪 学习实验室 7 阶段完整路径
- 🌸 可拖拽樱花花瓣系统
- 🎨 双主题模式（日樱/夜樱）
- 🔍 全文搜索功能
- 💬 Giscus 评论集成
- 🎵 音乐播放器

### v1.0.0

- 🎉 初始版本发布
- 📝 Markdown 笔记系统
- 🌐 中英双语支持
- 📱 响应式设计

---

## 📄 License

[MIT License](LICENSE) © 2024-present

---

<div align="center">

**🌸 愿这个项目成为你整理知识、分享生活的小花园 🌸**

Made with ❤️ by [soft-zihan](https://github.com/soft-zihan)

</div>
